knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(xtable)
library(BradleyTerry2)
library(dplyr)
library(ggplot2)
library(knitr)
player_data <- as.data.frame(matrix(NA, nrow=20, ncol=2))
colnames(player_data) <- c("First Name", "Last Name")
player_data[1, ] <- list("Nikola", "Surjanovic")
player_data[2, ] <- list("Dani", "Chu")
player_data[3, ] <- list("Nate", "S")
player_data[4, ] <- list("Jacob", "Mortensen")
player_data[5, ] <- list("Peter", "Tea")
player_data[6, ] <- list("James", "Thomson")
player_data[7, ] <- list("Barinder", "Thind")
player_data[8, ] <- list("Matthew", "R")
player_data[9, ] <- list("Renny", "Doig")
player_data[10, ] <- list("Lloyd", "Elliott")
player_data[11, ] <- list("Neil", "Faught")
player_data[12, ] <- list("Harsha", "Perera")
player_data[13, ] <- list("Claudine", "Tu")
player_data <- player_data[1:(which.max(is.na(player_data[,1]))-1), ]
match_data <- as.data.frame(matrix(NA, nrow=100, ncol=5))
colnames(match_data) <- c("player1", "player2", "winner", "score", "date")
match_data[1, ] <- list("Harsha Perera", "James Thomson", 1, "11-1, 11-4, 11-2", "13/09/2019")
match_data <- match_data[1:(which.max(is.na(match_data[,1]))-1), ]
# Sort by date (newest to oldest)
match_data$date <- as.Date(match_data$date, "%d/%m/%Y")
match_data <- match_data %>% dplyr::arrange(desc(date))
# Make sure that names are in lexicographic order and converted into factors
inds <- match_data$player1 > match_data$player2
x <- match_data[inds, 1]
match_data[inds, 1] <- match_data[inds, 2]
match_data[inds, 2] <- x
match_data[inds, 3] <- ((match_data[inds, 3]) %% 2) + 1 # 1 --> 2, 2 --> 1
rm(x, inds)
active_players <- unique(c(match_data$player1, match_data$player2))
match_data$player1 <- as.factor(match_data$player1)
match_data$player2 <- as.factor(match_data$player2)
match_data$player1 <- factor(match_data$player1, levels=active_players)
match_data$player2 <- factor(match_data$player2, levels=active_players)
h2h_data <- match_data %>%
dplyr::group_by(player1, player2) %>%
dplyr::summarise(win1 = sum(winner==1), win2 = sum(winner==2))
# Get Bradley-Terry rankings
BT_model <- BTm(outcome = cbind(win1, win2), player1 = as.factor(player1), player2 = as.factor(player2), data=h2h_data)
rank_data <- as.data.frame(BTabilities(BT_model))
BT_model
rank_data <- as.data.frame(BTabilities(BT_model))
BTabilities(BT_model)
?BTabilities
View(h2h_data)
View(match_data)
View(player_data)
BT_model
View(BTabilities())
View(BTabilities)
str(match_data)
install.packages(c("BradleyTerry2", "xtable"))
install.packages("BradleyTerry2")
